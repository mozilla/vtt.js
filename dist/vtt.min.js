/* vtt.js - v0.12.1 (https://github.com/mozilla/vtt.js) built on 06-06-2016 */
!function(a){function b(a){if("string"!=typeof a)return!1;var b=g[a.toLowerCase()];return b?a.toLowerCase():!1}function c(a){if("string"!=typeof a)return!1;var b=h[a.toLowerCase()];return b?a.toLowerCase():!1}function d(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}function e(a,e,g){var h=this,i=/MSIE\s8\.0/.test(navigator.userAgent),j={};i?h=document.createElement("custom"):j.enumerable=!0,h.hasBeenReset=!1;var k="",l=!1,m=a,n=e,o=g,p=null,q="",r=!0,s="auto",t="start",u=50,v="middle",w=50,x="middle";return Object.defineProperty(h,"id",d({},j,{get:function(){return k},set:function(a){k=""+a}})),Object.defineProperty(h,"pauseOnExit",d({},j,{get:function(){return l},set:function(a){l=!!a}})),Object.defineProperty(h,"startTime",d({},j,{get:function(){return m},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");m=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",d({},j,{get:function(){return n},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");n=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",d({},j,{get:function(){return o},set:function(a){o=""+a,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",d({},j,{get:function(){return p},set:function(a){p=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",d({},j,{get:function(){return q},set:function(a){var c=b(a);if(c===!1)throw new SyntaxError("An invalid or illegal string was specified.");q=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",d({},j,{get:function(){return r},set:function(a){r=!!a,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",d({},j,{get:function(){return s},set:function(a){if("number"!=typeof a&&a!==f)throw new SyntaxError("An invalid number or illegal string was specified.");s=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",d({},j,{get:function(){return t},set:function(a){var b=c(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");t=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",d({},j,{get:function(){return u},set:function(a){if(0>a||a>100)throw new Error("Position must be between 0 and 100.");u=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",d({},j,{get:function(){return v},set:function(a){var b=c(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");v=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",d({},j,{get:function(){return w},set:function(a){if(0>a||a>100)throw new Error("Size must be between 0 and 100.");w=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",d({},j,{get:function(){return x},set:function(a){var b=c(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");x=b,this.hasBeenReset=!0}})),h.displayState=void 0,i?h:void 0}var f="auto",g={"":!0,lr:!0,rl:!0},h={start:!0,middle:!0,end:!0,left:!0,right:!0};e.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},a.VTTCue=e||a.VTTCue}(this),function(a){function b(a){if("string"!=typeof a)return!1;var b=e[a.toLowerCase()];return b?a.toLowerCase():!1}function c(a){return"number"==typeof a&&a>=0&&100>=a}function d(){var a=100,d=3,e=0,f=100,g=0,h=100,i="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(b){if(!c(b))throw new Error("Width must be between 0 and 100.");a=b}},lines:{enumerable:!0,get:function(){return d},set:function(a){if("number"!=typeof a)throw new TypeError("Lines must be set to a number.");d=a}},regionAnchorY:{enumerable:!0,get:function(){return f},set:function(a){if(!c(a))throw new Error("RegionAnchorX must be between 0 and 100.");f=a}},regionAnchorX:{enumerable:!0,get:function(){return e},set:function(a){if(!c(a))throw new Error("RegionAnchorY must be between 0 and 100.");e=a}},viewportAnchorY:{enumerable:!0,get:function(){return h},set:function(a){if(!c(a))throw new Error("ViewportAnchorY must be between 0 and 100.");h=a}},viewportAnchorX:{enumerable:!0,get:function(){return g},set:function(a){if(!c(a))throw new Error("ViewportAnchorX must be between 0 and 100.");g=a}},scroll:{enumerable:!0,get:function(){return i},set:function(a){var c=b(a);if(c===!1)throw new SyntaxError("An invalid or illegal string was specified.");i=c}}})}var e={"":!0,up:!0};a.VTTRegion=a.VTTRegion||d}(this),function(a){function b(a,b){return void 0===b&&(b=1),"rgba("+[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16),b].join(",")+")"}function c(a,c,d){switch(d){case"webvtt.font.color":case"webvtt.font.opacity":var e=Services.prefs.getCharPref("webvtt.font.color"),f=Services.prefs.getIntPref("webvtt.font.opacity")/100;t.fontSet=b(e,f);break;case"webvtt.font.scale":s=Services.prefs.getIntPref("webvtt.font.scale")/100;break;case"webvtt.bg.color":case"webvtt.bg.opacity":var g=Services.prefs.getCharPref("webvtt.bg.color"),h=Services.prefs.getIntPref("webvtt.bg.opacity")/100;t.backgroundSet=b(g,h);break;case"webvtt.edge.color":case"webvtt.edge.type":var i=["","0px 0px ","4px 4px 4px ","-2px -2px ","2px 2px "],j=Services.prefs.getIntPref("webvtt.edge.type"),k=Services.prefs.getCharPref("webvtt.edge.color");t.edgeSet=i[j]+b(k)}}function d(a,b){this.name="ParsingError",this.code=a.code,this.message=b||a.message}function e(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1e3}var c=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return c?c[3]?b(c[1],c[2],c[3].replace(":",""),c[4]):c[1]>59?b(c[1],c[2],0,c[4]):b(0,c[1],c[2],c[4]):null}function f(){this.values=u(null)}function g(a,b,c,d){var e=d?a.split(d):[a];for(var f in e)if("string"==typeof e[f]){var g=e[f].split(c);if(2===g.length){var h=g[0],i=g[1];b(h,i)}}}function h(a,b,c){function h(){var b=e(a);if(null===b)throw new d(d.Errors.BadTimeStamp,"Malformed timestamp: "+k);return a=a.replace(/^[^\sa-zA-Z-]+/,""),b}function i(a,b){var d=new f;g(a,function(a,b){switch(a){case"region":for(var e=c.length-1;e>=0;e--)if(c[e].id===b){d.set(a,c[e].region);break}break;case"vertical":d.alt(a,b,["rl","lr"]);break;case"line":var f=b.split(","),g=f[0];d.integer(a,g),d.percent(a,g)?d.set("snapToLines",!1):null,d.alt(a,g,["auto"]),2===f.length&&d.alt("lineAlign",f[1],["start","middle","end"]);break;case"position":f=b.split(","),d.percent(a,f[0]),2===f.length&&d.alt("positionAlign",f[1],["start","middle","end"]);break;case"size":d.percent(a,b);break;case"align":d.alt(a,b,["start","middle","end","left","right"])}},/:/,/\s/),b.region=d.get("region",null),b.vertical=d.get("vertical",""),b.line=d.get("line","auto"),b.lineAlign=d.get("lineAlign","start"),b.snapToLines=d.get("snapToLines",!0),b.size=d.get("size",100),b.align=d.get("align","middle"),b.position=d.get("position",{start:0,left:0,middle:50,end:100,right:100},b.align),b.positionAlign=d.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},b.align)}function j(){a=a.replace(/^\s+/,"")}var k=a;if(j(),b.startTime=h(),j(),"-->"!==a.substr(0,3))throw new d(d.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+k);a=a.substr(3),j(),b.endTime=h(),j(),i(a,b)}function i(a,b){function c(){function a(a){return b=b.substr(a.length),a}if(!b)return null;var c=b.match(/^([^<]*)(<[^>]+>?)?/);return a(c[1]?c[1]:c[2])}function d(a){return v[a]}function f(a){for(;o=a.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)a=a.replace(o[0],d);return a}function g(a,b){return!y[b.localName]||y[b.localName]===a.localName}function h(b,c){var d=w[b];if(!d)return null;var e=a.document.createElement(d);e.localName=d;var f=x[b];return f&&c&&(e[f]=c.trim()),e}for(var i,j=a.document.createElement("div"),k=j,l=[];null!==(i=c());)if("<"!==i[0])k.appendChild(a.document.createTextNode(f(i)));else{if("/"===i[1]){l.length&&l[l.length-1]===i.substr(2).replace(">","")&&(l.pop(),k=k.parentNode);continue}var m,n=e(i.substr(1,i.length-2));if(n){m=a.document.createProcessingInstruction("timestamp",n),k.appendChild(m);continue}var o=i.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!o)continue;if(m=h(o[1],o[3]),!m)continue;if(!g(k,m))continue;o[2]&&(m.className=o[2].substr(1).replace("."," ")),l.push(o[1]),k.appendChild(m),k=m}return j}function j(a){for(var b=0;b<z.length;b++){var c=z[b];if(a>=c[0]&&a<=c[1])return!0}return!1}function k(a){function b(a,b){for(var c=b.childNodes.length-1;c>=0;c--)a.push(b.childNodes[c])}function c(a){if(!a||!a.length)return null;var d=a.pop(),e=d.textContent||d.innerText;if(e){var f=e.match(/^.*(\n|\r)/);return f?(a.length=0,f[0]):e}return"ruby"===d.tagName?c(a):d.childNodes?(b(a,d),c(a)):void 0}var d,e=[],f="";if(!a||!a.childNodes)return"ltr";for(b(e,a);f=c(e);)for(var g=0;g<f.length;g++)if(d=f.charCodeAt(g),j(d))return"rtl";return"ltr"}function l(a){if("number"==typeof a.line&&(a.snapToLines||a.line>=0&&a.line<=100))return a.line;if(!a.track||!a.track.textTrackList||!a.track.textTrackList.mediaElement)return-1;for(var b=a.track,c=b.textTrackList,d=0,e=0;e<c.length&&c[e]!==b;e++)"showing"===c[e].mode&&d++;return-1*++d}function m(){}function n(a,b){var c="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent),d="rgba(255, 255, 255, 1)",e="rgba(0, 0, 0, 0.8)",f="";"undefined"!=typeof t&&(d=t.fontSet,e=t.backgroundSet,f=t.edgeSet),c&&(d="rgb(255, 255, 255)",e="rgb(0, 0, 0)"),m.call(this),this.cue=b,this.cueDiv=i(a,b.text),this.cueDiv.className="jw-text-track-cue";var g={textShadow:f,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};c||(g.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl",g.unicodeBidi="plaintext"),this.applyStyles(g,this.cueDiv),this.div=a.document.createElement("div"),g={textAlign:"middle"===b.align?"center":b.align,whiteSpace:"pre-line",position:"absolute"},c||(g.direction=k(this.cueDiv),g.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(g),this.div.appendChild(this.cueDiv);var h=0;switch(b.positionAlign){case"start":h=b.position;break;case"middle":h=b.position-b.size/2;break;case"end":h=b.position-b.size}""===b.vertical?this.applyStyles({left:this.formatStyle(h,"%"),width:this.formatStyle(b.size,"%")}):this.applyStyles({top:this.formatStyle(h,"%"),height:this.formatStyle(b.size,"%")}),this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:"auto",width:this.formatStyle(a.width,"px")})}}function o(a){var b,c,d,e,f="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);if(a.div){c=a.div.offsetHeight,d=a.div.offsetWidth,e=a.div.offsetTop;var g=(g=a.div.childNodes)&&(g=g[0])&&g.getClientRects&&g.getClientRects();a=a.div.getBoundingClientRect(),b=g?Math.max(g[0]&&g[0].height||0,a.height/g.length):0}this.left=a.left,this.right=a.right,this.top=a.top||e,this.height=a.height||c,this.bottom=a.bottom||e+(a.height||c),this.width=a.width||d,this.lineHeight=void 0!==b?b:a.lineHeight,f&&!this.lineHeight&&(this.lineHeight=13)}function p(a,b,c,d){function e(a,b){for(var e,f=new o(a),g=1,h=0;h<b.length;h++){for(;a.overlapsOppositeAxis(c,b[h])||a.within(c)&&a.overlapsAny(d);)a.move(b[h]);if(a.within(c))return a;var i=a.intersectPercentage(c);g>i&&(e=new o(a),g=i),a=new o(f)}return e||f}var f=new o(b),g=b.cue,h=l(g),i=[];if(g.snapToLines){var j;switch(g.vertical){case"":i=["+y","-y"],j="height";break;case"rl":i=["+x","-x"],j="width";break;case"lr":i=["-x","+x"],j="width"}var k=f.lineHeight,m=k*Math.round(h),n=c[j]+k,p=i[0];Math.abs(m)>n&&(m=0>m?-1:1,m*=Math.ceil(n/k)*k),0>h&&(m+=""===g.vertical?c.height:c.width,i=i.reverse()),f.move(p,m)}else{var q=f.lineHeight/c.height*100;switch(g.lineAlign){case"middle":h-=q/2;break;case"end":h-=q}switch(g.vertical){case"":b.applyStyles({top:b.formatStyle(h,"%")});break;case"rl":b.applyStyles({left:b.formatStyle(h,"%")});break;case"lr":b.applyStyles({right:b.formatStyle(h,"%")})}i=["+y","-x","+x","-y"],f=new o(b)}var r=e(f,i);b.move(r.toCSSCompatValues(c))}function q(){}var r=["webvtt.font.color","webvtt.font.opacity","webvtt.font.scale","webvtt.bg.color","webvtt.bg.opacity","webvtt.edge.color","webvtt.edge.type"],s=1;if("undefined"!=typeof Services){var t={};r.forEach(function(a){c(void 0,void 0,a),Services.prefs.addObserver(a,c,!1)})}var u=Object.create||function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return a.prototype=b,new a}}();d.prototype=u(Error.prototype),d.prototype.constructor=d,d.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},f.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){var c;return(c=b.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(b=parseFloat(b),b>=0&&100>=b)?(this.set(a,b),!0):!1}};var v={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},w={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},x={v:"title",lang:"lang"},y={rt:"ruby"},z=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];m.prototype.applyStyles=function(a,b){b=b||this.div;for(var c in a)a.hasOwnProperty(c)&&(b.style[c]=a[c])},m.prototype.formatStyle=function(a,b){return 0===a?0:a+b},n.prototype=u(m.prototype),n.prototype.constructor=n,o.prototype.move=function(a,b){switch(b=void 0!==b?b:this.lineHeight,a){case"+x":this.left+=b,this.right+=b;break;case"-x":this.left-=b,this.right-=b;break;case"+y":this.top+=b,this.bottom+=b;break;case"-y":this.top-=b,this.bottom-=b}},o.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top},o.prototype.overlapsAny=function(a){for(var b=0;b<a.length;b++)if(this.overlaps(a[b]))return!0;return!1},o.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right},o.prototype.overlapsOppositeAxis=function(a,b){switch(b){case"+x":return this.left<a.left;case"-x":return this.right>a.right;case"+y":return this.top<a.top;case"-y":return this.bottom>a.bottom}},o.prototype.intersectPercentage=function(a){var b=Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left)),c=Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top)),d=b*c;return d/(this.height*this.width)},o.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}},o.getSimpleBoxPosition=function(a){var b=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,c=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,d=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a;var e={left:a.left,right:a.right,top:a.top||d,height:a.height||b,bottom:a.bottom||d+(a.height||b),width:a.width||c};return e},q.StringDecoder=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}},q.convertCueToDOMTree=function(a,b){return a&&b?i(a,b):null};var A="1.5%";q.processCues=function(a,b,c){function d(a){for(var b=0;b<a.length;b++)if(a[b].hasBeenReset||!a[b].displayState)return!0;return!1}if(!a||!b||!c)return null;for(;c.firstChild;)c.removeChild(c.firstChild);var e=a.document.createElement("div");if(e.className="jw-text-track-container",e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin=A,c.appendChild(e),d(b)){var f=[],g=o.getSimpleBoxPosition(e);!function(){for(var c,d,h=0;h<b.length;h++)d=b[h],c=new n(a,d),c.div.className="jw-text-track-display",e.appendChild(c.div),p(a,c,g,f),d.displayState=c.div,f.push(o.getSimpleBoxPosition(c))}()}else for(var h=0;h<b.length;h++)e.appendChild(b[h].displayState)},q.Parser=function(a,b){this.window=a,this.state="INITIAL",this.buffer="",this.decoder=b||new TextDecoder("utf8"),this.regionList=[]},q.Parser.prototype={reportOrThrowError:function(a){if(!(a instanceof d))throw a;this.onparsingerror&&this.onparsingerror(a)},parse:function(a){function b(){for(var a=i.buffer,b=0;b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,i.buffer=a.substr(b),c}function c(a){var b=new f;if(g(a,function(a,c){switch(a){case"id":b.set(a,c);break;case"width":b.percent(a,c);break;case"lines":b.integer(a,c);break;case"regionanchor":case"viewportanchor":var d=c.split(",");if(2!==d.length)break;var e=new f;if(e.percent("x",d[0]),e.percent("y",d[1]),!e.has("x")||!e.has("y"))break;b.set(a+"X",e.get("x")),b.set(a+"Y",e.get("y"));break;case"scroll":b.alt(a,c,["up"])}},/=/,/\s/),b.has("id")){var c=new i.window.VTTRegion;c.width=b.get("width",100),c.lines=b.get("lines",3),c.regionAnchorX=b.get("regionanchorX",0),c.regionAnchorY=b.get("regionanchorY",100),c.viewportAnchorX=b.get("viewportanchorX",0),c.viewportAnchorY=b.get("viewportanchorY",100),c.scroll=b.get("scroll",""),i.onregion&&i.onregion(c),i.regionList.push({id:b.get("id"),region:c})}}function e(a){g(a,function(a,b){switch(a){case"Region":c(b)}},/:/)}var i=this;a&&(i.buffer+=i.decoder.decode(a,{stream:!0}));try{var j;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;j=b();var k=j.match(/^WEBVTT([ \t].*)?$/);if(!k||!k[0])throw new d(d.Errors.BadSignature);i.state="HEADER"}for(var l=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(l?l=!1:j=b(),i.state){case"HEADER":/:/.test(j)?e(j):j||(i.state="ID");continue;case"NOTE":j||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(j)){i.state="NOTE";break}if(!j)continue;if(i.cue=new i.window.VTTCue(0,0,""),i.state="CUE",-1===j.indexOf("-->")){i.cue.id=j;continue}case"CUE":try{h(j,i.cue,i.regionList)}catch(m){i.reportOrThrowError(m),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var n=-1!==j.indexOf("-->");if(!j||n&&(l=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=j;continue;case"BADCUE":j||(i.state="ID");continue}}}catch(m){i.reportOrThrowError(m),"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),(a.cue||"HEADER"===a.state)&&(a.buffer+="\n\n",a.parse()),"INITIAL"===a.state)throw new d(d.Errors.BadSignature)}catch(b){a.reportOrThrowError(b)}return a.onflush&&a.onflush(),this}},a.WebVTT=q}(this),"undefined"!=typeof module&&module.exports&&(this["encoding-indexes"]=require("./encoding-indexes.js")["encoding-indexes"]),function(a){"use strict";function b(a,b,c){return a>=b&&c>=a}function c(a,b){return Math.floor(a/b)}function d(a){var b=0;this.get=function(){return b>=a.length?O:Number(a[b])},this.offset=function(c){if(b+=c,0>b)throw new Error("Seeking past start of the buffer");if(b>a.length)throw new Error("Seeking past EOF")},this.match=function(c){if(c.length>b+a.length)return!1;var d;for(d=0;d<c.length;d+=1)if(Number(a[b+d])!==c[d])return!1;return!0}}function e(a){var b=0;this.emit=function(c){var d,e=O;for(d=0;d<arguments.length;++d)e=Number(arguments[d]),a[b++]=e;return e}}function f(a){function c(a){for(var c=[],d=0,e=a.length;d<a.length;){var f=a.charCodeAt(d);if(b(f,55296,57343))if(b(f,56320,57343))c.push(65533);else if(d===e-1)c.push(65533);else{var g=a.charCodeAt(d+1);if(b(g,56320,57343)){var h=1023&f,i=1023&g;d+=1,c.push(65536+(h<<10)+i)}else c.push(65533)}else c.push(f);d+=1}return c}var d=0,e=c(a);this.offset=function(a){if(d+=a,0>d)throw new Error("Seeking past start of the buffer");if(d>e.length)throw new Error("Seeking past EOF")},this.get=function(){return d>=e.length?P:e[d]}}function g(){var a="";this.string=function(){return a},this.emit=function(b){65535>=b?a+=String.fromCharCode(b):(b-=65536,a+=String.fromCharCode(55296+(b>>10&1023)),a+=String.fromCharCode(56320+(1023&b)))}}function h(a){this.name="EncodingError",this.message=a,this.code=0}function i(a,b){if(a)throw new h("Decoder error");return b||65533}function j(a){throw new h("The code point "+a+" could not be encoded.")}function k(a){return a=String(a).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(S,a)?S[a]:null}function l(a,b){return b?b[a]||null:null}function m(a,b){var c=b.indexOf(a);return-1===c?null:c}function n(b){if(!("encoding-indexes"in a))throw new Error("Indexes missing. Did you forget to include encoding-indexes.js?");return a["encoding-indexes"][b]}function o(a){if(a>39419&&189e3>a||a>1237575)return null;var b,c=0,d=0,e=n("gb18030");for(b=0;b<e.length;++b){var f=e[b];if(!(f[0]<=a))break;c=f[0],d=f[1]}return d+a-c}function p(a){var b,c=0,d=0,e=n("gb18030");for(b=0;b<e.length;++b){var f=e[b];if(!(f[1]<=a))break;c=f[1],d=f[0]}return d+a-c}function q(a,b){if(!(this instanceof q))return new q(a,b);if(a=a?String(a):T,b=Object(b),this._encoding=k(a),null===this._encoding||"replacement"===this._encoding.name)throw new TypeError("Unknown encoding: "+a);if(!this._encoding.getDecoder)throw new Error("Decoder not present. Did you forget to include encoding-indexes.js?");return this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._options={fatal:Boolean(b.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this}function r(a,b){if(!(this instanceof r))return new r(a,b);a=a?String(a):T,b=Object(b),this._encoding=k(a);var c=b.NONSTANDARD_allowLegacyEncoding,d="utf-8"!==this._encoding.name&&"utf-16le"!==this._encoding.name&&"utf-16be"!==this._encoding.name;if(null===this._encoding||d&&!c)throw new TypeError("Unknown encoding: "+a);if(!this._encoding.getEncoder)throw new Error("Encoder not present. Did you forget to include encoding-indexes.js?");return this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(b.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this}function s(a){var c=a.fatal,d=0,e=0,f=0,g=0;this.decode=function(a){var h=a.get();if(h===O)return 0!==e?i(c):P;if(a.offset(1),0===e){if(b(h,0,127))return h;if(b(h,194,223))e=1,g=128,d=h-192;else if(b(h,224,239))e=2,g=2048,d=h-224;else{if(!b(h,240,244))return i(c);e=3,g=65536,d=h-240}return d*=Math.pow(64,e),null}if(!b(h,128,191))return d=0,e=0,f=0,g=0,a.offset(-1),i(c);if(f+=1,d+=(h-128)*Math.pow(64,e-f),f!==e)return null;var j=d,k=g;return d=0,e=0,f=0,g=0,b(j,k,1114111)&&!b(j,55296,57343)?j:i(c)}}function t(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,55296,57343))return j(e);if(b(e,0,127))return a.emit(e);var f,g;b(e,128,2047)?(f=1,g=192):b(e,2048,65535)?(f=2,g=224):b(e,65536,1114111)&&(f=3,g=240);for(var h=a.emit(c(e,Math.pow(64,f))+g);f>0;){var i=c(e,Math.pow(64,f-1));h=a.emit(128+i%64),f-=1}return h}}function u(a,c){var d=c.fatal;this.decode=function(c){var e=c.get();if(e===O)return P;if(c.offset(1),b(e,0,127))return e;var f=a[e-128];return null===f?i(d):f}}function v(a,c){c.fatal;this.encode=function(c,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,127))return c.emit(e);var f=m(e,a);return null===f&&j(e),c.emit(f+128)}}function w(a){var c=a.fatal,d=0,e=0,f=0;this.decode=function(a){var g=a.get();if(g===O&&0===d&&0===e&&0===f)return P;g!==O||0===d&&0===e&&0===f||(d=0,e=0,f=0,i(c)),a.offset(1);var h;if(0!==f)return h=null,b(g,48,57)&&(h=o(10*(126*(10*(d-129)+(e-48))+(f-129))+g-48)),d=0,e=0,f=0,null===h?(a.offset(-3),i(c)):h;if(0!==e)return b(g,129,254)?(f=g,null):(a.offset(-2),d=0,e=0,i(c));if(0!==d){if(b(g,48,57))return e=g,null;var j=d,k=null;d=0;var m=127>g?64:65;return(b(g,64,126)||b(g,128,254))&&(k=190*(j-129)+(g-m)),h=null===k?null:l(k,n("gb18030")),null===k&&a.offset(-1),null===h?i(c):h}return b(g,0,127)?g:128===g?8364:b(g,129,254)?(d=g,null):i(c)}}function x(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,127))return a.emit(e);var f=m(e,n("gb18030"));if(null!==f){var g=c(f,190)+129,h=f%190,i=63>h?64:65;return a.emit(g,h+i)}f=p(e);var j=c(c(c(f,10),126),10);f-=10*j*126*10;var k=c(c(f,10),126);f-=10*k*126;var l=c(f,10),o=f-10*l;return a.emit(j+129,k+48,l+129,o+48)}}function y(a){var c=a.fatal,d=!1,e=0;this.decode=function(a){var f=a.get();if(f===O&&0===e)return P;if(f===O&&0!==e)return e=0,i(c);if(a.offset(1),126===e)return e=0,123===f?(d=!0,null):125===f?(d=!1,null):126===f?126:10===f?null:(a.offset(-1),i(c));if(0!==e){var g=e;e=0;var h=null;return b(f,33,126)&&(h=l(190*(g-1)+(f+63),n("gb18030"))),10===f&&(d=!1),null===h?i(c):h}return 126===f?(e=126,null):d?b(f,32,127)?(e=f,null):(10===f&&(d=!1),i(c)):b(f,0,127)?f:i(c)}}function z(a){var d=(a.fatal,!1);this.encode=function(a,e){var f=e.get();if(f===P)return O;if(e.offset(1),b(f,0,127)&&d)return e.offset(-1),d=!1,a.emit(126,125);if(126===f)return a.emit(126,126);if(b(f,0,127))return a.emit(f);if(!d)return e.offset(-1),d=!0,a.emit(126,123);var g=m(f,n("gb18030"));if(null===g)return j(f);var h=c(g,190)+1,i=g%190-63;return b(h,33,126)&&b(i,33,126)?a.emit(h,i):j(f)}}function A(a){var c=a.fatal,d=0,e=null;this.decode=function(a){if(null!==e){var f=e;return e=null,f}var g=a.get();if(g===O&&0===d)return P;if(g===O&&0!==d)return d=0,i(c);if(a.offset(1),0!==d){var h=d,j=null;d=0;var k=127>g?64:98;if((b(g,64,126)||b(g,161,254))&&(j=157*(h-129)+(g-k)),1133===j)return e=772,202;if(1135===j)return e=780,202;if(1164===j)return e=772,234;if(1166===j)return e=780,234;var m=null===j?null:l(j,n("big5"));return null===j&&a.offset(-1),null===m?i(c):m}return b(g,0,127)?g:b(g,129,254)?(d=g,null):i(c)}}function B(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,127))return a.emit(e);var f=m(e,n("big5"));if(null===f)return j(e);var g=c(f,157)+129,h=f%157,i=63>h?64:98;return a.emit(g,h+i)}}function C(a){var c=a.fatal,d=0,e=0;this.decode=function(a){var f=a.get();if(f===O)return 0===d&&0===e?P:(d=0,e=0,i(c));a.offset(1);var g,h;return 0!==e?(g=e,e=0,h=null,b(g,161,254)&&b(f,161,254)&&(h=l(94*(g-161)+f-161,n("jis0212"))),b(f,161,254)||a.offset(-1),null===h?i(c):h):142===d&&b(f,161,223)?(d=0,65377+f-161):143===d&&b(f,161,254)?(d=0,e=f,null):0!==d?(g=d,d=0,h=null,b(g,161,254)&&b(f,161,254)&&(h=l(94*(g-161)+f-161,n("jis0208"))),b(f,161,254)||a.offset(-1),null===h?i(c):h):b(f,0,127)?f:142===f||143===f||b(f,161,254)?(d=f,null):i(c)}}function D(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,127))return a.emit(e);if(165===e)return a.emit(92);if(8254===e)return a.emit(126);if(b(e,65377,65439))return a.emit(142,e-65377+161);var f=m(e,n("jis0208"));if(null===f)return j(e);var g=c(f,94)+161,h=f%94+161;return a.emit(g,h)}}function E(a){var c=a.fatal,d={ASCII:0,escape_start:1,escape_middle:2,escape_final:3,lead:4,trail:5,Katakana:6},e=d.ASCII,f=!1,g=0;this.decode=function(a){var h=a.get();switch(h!==O&&a.offset(1),e){default:case d.ASCII:return 27===h?(e=d.escape_start,null):b(h,0,127)?h:h===O?P:i(c);case d.escape_start:return 36===h||40===h?(g=h,e=d.escape_middle,null):(h!==O&&a.offset(-1),e=d.ASCII,i(c));case d.escape_middle:var j=g;return g=0,36!==j||64!==h&&66!==h?36===j&&40===h?(e=d.escape_final,null):40!==j||66!==h&&74!==h?40===j&&73===h?(e=d.Katakana,null):(h===O?a.offset(-1):a.offset(-2),e=d.ASCII,i(c)):(e=d.ASCII,null):(f=!1,e=d.lead,null);case d.escape_final:return 68===h?(f=!0,e=d.lead,null):(h===O?a.offset(-2):a.offset(-3),e=d.ASCII,i(c));case d.lead:return 10===h?(e=d.ASCII,i(c,10)):27===h?(e=d.escape_start,null):h===O?P:(g=h,e=d.trail,null);case d.trail:if(e=d.lead,h===O)return i(c);var k=null,m=94*(g-33)+h-33;return b(g,33,126)&&b(h,33,126)&&(k=f===!1?l(m,n("jis0208")):l(m,n("jis0212"))),null===k?i(c):k;case d.Katakana:return 27===h?(e=d.escape_start,null):b(h,33,95)?65377+h-33:h===O?P:i(c)}}}function F(a){var d=(a.fatal,{ASCII:0,lead:1,Katakana:2}),e=d.ASCII;this.encode=function(a,f){var g=f.get();if(g===P)return O;if(f.offset(1),(b(g,0,127)||165===g||8254===g)&&e!==d.ASCII)return f.offset(-1),e=d.ASCII,a.emit(27,40,66);if(b(g,0,127))return a.emit(g);if(165===g)return a.emit(92);if(8254===g)return a.emit(126);if(b(g,65377,65439)&&e!==d.Katakana)return f.offset(-1),e=d.Katakana,a.emit(27,40,73);if(b(g,65377,65439))return a.emit(g-65377-33);if(e!==d.lead)return f.offset(-1),e=d.lead,a.emit(27,36,66);var h=m(g,n("jis0208"));if(null===h)return j(g);var i=c(h,94)+33,k=h%94+33;return a.emit(i,k)}}function G(a){var c=a.fatal,d=0;this.decode=function(a){var e=a.get();if(e===O&&0===d)return P;if(e===O&&0!==d)return d=0,i(c);if(a.offset(1),0!==d){var f=d;if(d=0,b(e,64,126)||b(e,128,252)){var g=127>e?64:65,h=160>f?129:193,j=l(188*(f-h)+e-g,n("jis0208"));return null===j?i(c):j}return a.offset(-1),i(c)}return b(e,0,128)?e:b(e,161,223)?65377+e-161:b(e,129,159)||b(e,224,252)?(d=e,null):i(c)}}function H(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,128))return a.emit(e);if(165===e)return a.emit(92);if(8254===e)return a.emit(126);if(b(e,65377,65439))return a.emit(e-65377+161);var f=m(e,n("jis0208"));if(null===f)return j(e);var g=c(f,188),h=31>g?129:193,i=f%188,k=63>i?64:65;return a.emit(g+h,i+k)}}function I(a){var c=a.fatal,d=0;this.decode=function(a){var e=a.get();if(e===O&&0===d)return P;if(e===O&&0!==d)return d=0,i(c);if(a.offset(1),0!==d){var f=d,g=null;if(d=0,b(f,129,198)){var h=178*(f-129);b(e,65,90)?g=h+e-65:b(e,97,122)?g=h+26+e-97:b(e,129,254)&&(g=h+26+26+e-129)}b(f,199,253)&&b(e,161,254)&&(g=12460+94*(f-199)+(e-161));var j=null===g?null:l(g,n("euc-kr"));return null===g&&a.offset(-1),null===j?i(c):j}return b(e,0,127)?e:b(e,129,253)?(d=e,null):i(c)}}function J(a){a.fatal;this.encode=function(a,d){var e=d.get();if(e===P)return O;if(d.offset(1),b(e,0,127))return a.emit(e);var f=m(e,n("euc-kr"));if(null===f)return j(e);var g,h;if(12460>f){g=c(f,178)+129,h=f%178;var i=26>h?65:52>h?71:77;return a.emit(g,h+i)}return f-=12460,g=c(f,94)+199,h=f%94+161,a.emit(g,h)}}function K(a,c){var d=c.fatal,e=null,f=null;this.decode=function(c){var g=c.get();if(g===O&&null===e&&null===f)return P;if(g===O&&(null!==e||null!==f))return i(d);if(c.offset(1),
null===e)return e=g,null;var h;if(h=a?(e<<8)+g:(g<<8)+e,e=null,null!==f){var j=f;return f=null,b(h,56320,57343)?65536+1024*(j-55296)+(h-56320):(c.offset(-2),i(d))}return b(h,55296,56319)?(f=h,null):b(h,56320,57343)?i(d):h}}function L(a,d){d.fatal;this.encode=function(d,e){function f(b){var c=b>>8,e=255&b;return a?d.emit(c,e):d.emit(e,c)}var g=e.get();if(g===P)return O;if(e.offset(1),b(g,55296,57343)&&j(g),65535>=g)return f(g);var h=c(g-65536,1024)+55296,i=(g-65536)%1024+56320;return f(h),f(i)}}function M(a){a.fatal;this.decode=function(a){var c=a.get();return c===O?P:(a.offset(1),b(c,0,127)?c:63360+c-128)}}function N(a,c){c.fatal;this.encode=function(a,c){var d=c.get();return d===P?O:(c.offset(1),b(d,0,127)?a.emit(d):b(d,63360,63487)?a.emit(d-63360+128):void j(d))}}var O=-1,P=-1;h.prototype=Error.prototype;var Q=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"utf-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"ibm866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso88592","iso_8859-2","iso_8859-2:1987","l2","latin2"],name:"iso-8859-2"},{labels:["csisolatin3","iso-8859-3","iso-ir-109","iso8859-3","iso88593","iso_8859-3","iso_8859-3:1988","l3","latin3"],name:"iso-8859-3"},{labels:["csisolatin4","iso-8859-4","iso-ir-110","iso8859-4","iso88594","iso_8859-4","iso_8859-4:1988","l4","latin4"],name:"iso-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso-ir-144","iso8859-5","iso88595","iso_8859-5","iso_8859-5:1988"],name:"iso-8859-5"},{labels:["arabic","asmo-708","csiso88596e","csiso88596i","csisolatinarabic","ecma-114","iso-8859-6","iso-8859-6-e","iso-8859-6-i","iso-ir-127","iso8859-6","iso88596","iso_8859-6","iso_8859-6:1987"],name:"iso-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso-ir-126","iso8859-7","iso88597","iso_8859-7","iso_8859-7:1987","sun_eu_greek"],name:"iso-8859-7"},{labels:["csiso88598e","csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-e","iso-ir-138","iso8859-8","iso88598","iso_8859-8","iso_8859-8:1988","visual"],name:"iso-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"iso-8859-8-i"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","iso885910","l6","latin6"],name:"iso-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"iso-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"iso-8859-14"},{labels:["csisolatin9","iso-8859-15","iso8859-15","iso885915","iso_8859-15","l9"],name:"iso-8859-15"},{labels:["iso-8859-16"],name:"iso-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"koi8-r"},{labels:["koi8-u"],name:"koi8-u"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["dos-874","iso-8859-11","iso8859-11","iso885911","tis-620","windows-874"],name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ansi_x3.4-1968","ascii","cp1252","cp819","csisolatin1","ibm819","iso-8859-1","iso-ir-100","iso8859-1","iso88591","iso_8859-1","iso_8859-1:1987","l1","latin1","us-ascii","windows-1252","x-cp1252"],name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:["cp1254","csisolatin5","iso-8859-9","iso-ir-148","iso8859-9","iso88599","iso_8859-9","iso_8859-9:1989","l5","latin5","windows-1254","x-cp1254"],name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb18030","gb2312","gb_2312","gb_2312-80","gbk","iso-ir-58","x-gbk"],name:"gb18030"},{labels:["hz-gb-2312"],name:"hz-gb-2312"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"euc-jp"},{labels:["csiso2022jp","iso-2022-jp"],name:"iso-2022-jp"},{labels:["csshiftjis","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"shift_jis"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"euc-kr"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"utf-16be"},{labels:["utf-16","utf-16le"],name:"utf-16le"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],R={},S={};Q.forEach(function(a){a.encodings.forEach(function(a){R[a.name]=a,a.labels.forEach(function(b){S[b]=a})})});var T="utf-8";q.prototype={decode:function(a,b){if(a&&!("buffer"in a&&"byteOffset"in a&&"byteLength"in a))throw new TypeError("Expected ArrayBufferView");a||(a=new Uint8Array(0)),b=Object(b),this._streaming||(this._decoder=this._encoding.getDecoder(this._options),this._BOMseen=!1),this._streaming=Boolean(b.stream);for(var c,e=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),f=new d(e),h=new g;f.get()!==O;)c=this._decoder.decode(f),null!==c&&c!==P&&h.emit(c);if(!this._streaming){do c=this._decoder.decode(f),null!==c&&c!==P&&h.emit(c);while(c!==P&&f.get()!=O);this._decoder=null}var i=h.string();return!this._BOMseen&&i.length&&(this._BOMseen=!0,-1!==["utf-8","utf-16le","utf-16be"].indexOf(this.encoding)&&65279===i.charCodeAt(0)&&(i=i.substring(1))),i}},r.prototype={encode:function(a,b){a=a?String(a):"",b=Object(b),this._streaming||(this._encoder=this._encoding.getEncoder(this._options)),this._streaming=Boolean(b.stream);for(var c=[],d=new e(c),g=new f(a);g.get()!==P;)this._encoder.encode(d,g);if(!this._streaming){var h;do h=this._encoder.encode(d,g);while(h!==O);this._encoder=null}return new Uint8Array(c)}},R["utf-8"].getEncoder=function(a){return new t(a)},R["utf-8"].getDecoder=function(a){return new s(a)},function(){"encoding-indexes"in a&&Q.forEach(function(a){"Legacy single-byte encodings"===a.heading&&a.encodings.forEach(function(a){var b=n(a.name);a.getDecoder=function(a){return new u(b,a)},a.getEncoder=function(a){return new v(b,a)}})})}(),R.gb18030.getEncoder=function(a){return new x(a)},R.gb18030.getDecoder=function(a){return new w(a)},R["hz-gb-2312"].getEncoder=function(a){return new z(a)},R["hz-gb-2312"].getDecoder=function(a){return new y(a)},R.big5.getEncoder=function(a){return new B(a)},R.big5.getDecoder=function(a){return new A(a)},R["euc-jp"].getEncoder=function(a){return new D(a)},R["euc-jp"].getDecoder=function(a){return new C(a)},R["iso-2022-jp"].getEncoder=function(a){return new F(a)},R["iso-2022-jp"].getDecoder=function(a){return new E(a)},R.shift_jis.getEncoder=function(a){return new H(a)},R.shift_jis.getDecoder=function(a){return new G(a)},R["euc-kr"].getEncoder=function(a){return new J(a)},R["euc-kr"].getDecoder=function(a){return new I(a)},R["utf-16be"].getEncoder=function(a){return new L(!0,a)},R["utf-16be"].getDecoder=function(a){return new K(!0,a)},R["utf-16le"].getEncoder=function(a){return new L(!1,a)},R["utf-16le"].getDecoder=function(a){return new K(!1,a)},R["x-user-defined"].getEncoder=function(a){return new N(!1,a)},R["x-user-defined"].getDecoder=function(a){return new M(!1,a)},"TextEncoder"in a||(a.TextEncoder=r),"TextDecoder"in a||(a.TextDecoder=q)}(this);